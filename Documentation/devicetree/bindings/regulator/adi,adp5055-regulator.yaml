# SPDX-License-Identifier: (GPL-2.0 OR BSD-2-Clause)
# Copyright (c) 2024 Analog Devices, Inc.
%YAML 1.2
---
$id: http://devicetree.org/schemas/regulator/adi,adp5055-regulator.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Analog Devices ADP5055 Triple Buck Regulator

maintainers:
  - Alexis Czezar Torreno <alexisczezar.torreno@analog.com>

description: |
  The ADP5055 combines three high performance buck regulators.
  The device enables direct connection to high input voltages
  up to 18 V with no preregulators.
  https://www.analog.com/media/en/technical-documentation/data-sheets/adp5055.pdf

allOf:
  - $ref: regulator.yaml#

properties:
  compatible:
    enum:
      - adi,adp5055

  reg:
    description:
      I2C address of the device. LSB depends on value of
      hardware pin CFG2.
    enum:
      - 0x70
      - 0x71

  adi,enable-mode-code:
    description:
      2-bit value to configure channel enabling
      0 - Physical EN pin is used for enabling.
      1 - Internal Register is used for enabling.
      2 - Both register and physical pin needed.
      3 - Either register or physical pin.
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 0
    maximum: 3
    default: 0

  adi,ocp-blanking:
    description:
      Enables or disables over current protection
      blanking (OCP) for all channels.
      0 = Disabled
      1 = Enabled
    type: boolean
    default: 0

  adi,power-saving-mode-ch321-code:
    description:
      3-bit value to enable power saving mode for
      individual channels. BIT[2:0] = [CH3, CH2, CH1].
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 0
    maximum: 7
    default: 0

  adi,output-discharge-function-ch321-code:
    description:
      3-bit value to enable output discharge functionality
      for individual channels. BIT[2:0] = [CH3, CH2, CH1].
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 0
    maximum: 7
    default: 7

  adi,disable-delay-code-ch123:
    description:
      An array of 3-bit values to configure the disable delay
      for each channel. {CH1[2:0], CH2[2:0], CH3[2:0].
      0 - No delay.
      1 - 2 * Tset
      2 - 4 * Tset
      3 - 6 * Tset
      4 - 8 * Tset
      5 - 10 * Tset
      6 - 12 * Tset
      7 - 14 * Tset
    $ref: /schemas/types.yaml#/definitions/uint32-array
    maxItems: 3
    items:
      minimum: 0
      maximum: 7
    default: 0, 0, 0

  adi,enable-delay-code-ch123:
    description:
      An array of 3-bit values to configure the enable delay
      for each channel. {CH1[2:0], CH2[2:0], CH3[2:0].
      0 - No delay.
      1 - 1 * Tset
      2 - 2 * Tset
      3 - 3 * Tset
      4 - 4 * Tset
      5 - 5 * Tset
      6 - 6 * Tset
      7 - 7 * Tset
    $ref: /schemas/types.yaml#/definitions/uint32-array
    maxItems: 3
    items:
      minimum: 0
      maximum: 7
    default: 0, 0, 0

  adi,dvs-limit-upper-code-ch123:
    description:
      An array of 4-bit values to configure the allowable upper
      side limit of the voltage output of each channel.
      {CH1[3:0], CH2[3:0], CH3[3:0].
      Vout_high = Vout + 192mV - (12mV * code)
    $ref: /schemas/types.yaml#/definitions/uint32-array
    maxItems: 3
    items:
      minimum: 0
      maximum: 15
    default: 0, 0, 0

  adi,dvs-limit-lower-code-ch123:
    description:
      An array of 4-bit values to configure the allowable lower
      side limit of the voltage output of each channel.
      {CH1[3:0], CH2[3:0], CH3[3:0].
      Vout_low = Vout - 190.5mV + (12mV * code)
    $ref: /schemas/types.yaml#/definitions/uint32-array
    maxItems: 3
    items:
      minimum: 0
      maximum: 15
    default: 0, 0, 0

  adi,fast-transient-code-ch123:
    description:
      An array of 2-bit values to configure the fast transient
      sensitivity for each channel. {CH1[1:0], CH2[1:0], CH3[1:0].
      0 - No fast transient.
      1 - 1.5% window with 3*350uA/V
      2 - 1.5% window with 5*350uA/V
      3 - 2.5% window with 5*350uA/V
    $ref: /schemas/types.yaml#/definitions/uint32-array
    maxItems: 3
    items:
      minimum: 0
      maximum: 3
    default: 3, 3, 3

  adi,delay-power-good:
    description:
      Configures delay timer of the power good (PWRGD) pin.
      0 - No delay.
      1 - Delay timer = Tset.
    type: boolean
    default: 1

  adi,mask-power-good-ch321-code:
    description:
      3-bit value to masks or unmasks individual channels to the
      external PWRGD hardware pin. BIT[2:0] = [CH3, CH2, CH1].
      0 - Outputs the PWRGD signal to the external PWRGD pin.
      1 - Masks the PWRGD signal to the external PWRGD pin.
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 0
    maximum: 7
    default: 0

required:
  - compatible
  - reg

unevaluatedProperties: false

examples:
  - |
    i2c {
        #address-cells = <1>;
        #size-cells = <0>;

        regulator@70 {
            compatible = "adi,adp5055";
            reg = <0x70>;

            adi,enable-mode-code = <0>;
            adi,ocp-blanking = <0>;
            adi,power-saving-mode-ch321-code = <7>;
            adi,output-discharge-function-ch321-code = <0>;
            adi,disable-delay-code-ch123 = <0>, <0>, <0>;
            adi,enable-delay-code-ch123 = <0>, <0>, <0>;
            adi,dvs-limit-upper-code-ch123 = <0>, <0>, <0>;
            adi,dvs-limit-lower-code-ch123 = <0>, <0>, <0>;
            adi,fast-transient-code-ch123 = <3>, <3>, <3>;
            adi,delay-power-good = <1>;
            adi,mask-power-good-ch321-code = <0>;

            regulator-min-microvolt = <408000>;
            regulator-max-microvolt = <790500>;
        };
    };
